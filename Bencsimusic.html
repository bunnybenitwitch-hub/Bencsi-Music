<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BencsiMusic - All Releases</title>
<style>
/* Reset & base */
* { box-sizing:border-box; margin:0; padding:0; }
body { font-family: 'Arial', sans-serif; background:#fbe3e8; color:#333; padding:20px; }

/* Container */
.container { max-width:800px; margin:auto; padding:20px; background:white; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
.box { margin-bottom:40px; }

/* Titles */
.Title { font-family:'Arial Black', sans-serif; font-size:50px; color:#ff4757; text-align:center; margin:30px 0 50px; }
.subtitle { font-family:'Arial Black', sans-serif; font-size:40px; margin-bottom:20px; color:#333; }
.text { font-size:20px; line-height:1.6; margin-bottom:30px; color:#555; }

/* Music Button */
.beat {
  font-family:'Arial Black', sans-serif;
  font-size:30px;
  color:white;
  background-color:#ff6f91;
  padding:14px 20px;
  border-radius:5px;
  text-decoration:none;
  display:inline-block;
  min-width:120px;
  text-align:center;
  cursor:pointer;
  transition: background 0.3s;
  touch-action: manipulation;
}
.beat:hover,
.beat:active { background-color:#ff4757; }

/* Review Tab */
.review-tab {
  position:fixed; right:-300px; top:40%; width:300px;
  background:white; border-radius:10px 0 0 10px;
  box-shadow:0 6px 15px rgba(0,0,0,0.15);
  transition:right 0.3s ease;
  z-index:9999;
}
.review-tab:hover { right:0; }

/* Review Tab Button */
.review-tab-button {
  position:absolute; left:-130px; top:50%; transform:translateY(-50%) rotate(-90deg);
  background-color:#ff6f91; color:white; padding:14px 22px;
  font-family:'Arial Black', sans-serif; font-size:16px; border-radius:10px 10px 0 0;
  cursor:pointer; user-select:none; touch-action: manipulation;
}
.review-tab-button:active { background-color:#ff4757; }

/* Review Content */
.review-tab-content { padding:20px; }
.review-title { font-family:'Arial Black', sans-serif; font-size:22px; color:#ff4757; margin-bottom:12px; }

/* Inputs */
.review-tab-content input,
.review-tab-content textarea {
  width:100%; padding:10px; margin-bottom:12px; font-size:14px; border-radius:5px; border:1px solid #ccc;
}
.review-tab-content textarea { resize:none; height:80px; }

/* Submit Button */
.review-tab-content button {
  width:100%; padding:14px; font-size:16px; background-color:#ff6f91; color:white; border:none; border-radius:5px;
  font-family:'Arial Black', sans-serif; cursor:pointer; transition: background 0.3s, transform 0.1s; touch-action: manipulation;
}
.review-tab-content button:hover,
.review-tab-content button:active { background-color:#ff4757; transform:scale(0.98); }

/* Reviews Display */
#reviews p { margin-bottom:12px; font-size:16px; line-height:1.4; }
</style>
</head>
<body>

<h1 class="Title">BencsiMusic - All <b>Releases</b></h1>

<div class="container">
  <div class="box">
    <h2 class="subtitle">Released Music</h2>
    <p class="text">Explore all the music tracks officially released by BencsiMusic. Enjoy beats and rhythms crafted with passion!</p>
    <a href="https://www.bandlab.com/track/480e0cc8-f8f1-f011-8d4d-002248444940?revId=460e0cc8-f8f1-f011-8d4d-002248444940" class="beat">Explore Released Music</a>
  </div>
</div>

<!-- Review Tab -->
<div class="review-tab">
  <div class="review-tab-button">Leave a Review</div>
  <div class="review-tab-content">
    <h3 class="review-title">Leave a Review</h3>
    <input type="text" id="nameInput" placeholder="Your name" />
    <textarea id="reviewInput" placeholder="Your review"></textarea>
    <button id="submitReviewBtn" type="button">Submit</button>
    <div id="form-message" style="margin-top:10px;"></div>
  </div>
</div>

<!-- Reviews Display -->
<div class="container box">
  <h2 class="subtitle">Reviews</h2>
  <div id="reviews"></div>
</div>

<!-- Firebase & JS -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDSX119jkUp2nqTuCthpm9Bc4EP8N7Mxuw",
  authDomain: "reviews-ee142.firebaseapp.com",
  projectId: "reviews-ee142",
  storageBucket: "reviews-ee142.appspot.com",
  messagingSenderId: "895911128020",
  appId: "1:895911128020:web:91662c5b75488b0c358441"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const reviewsDiv = document.getElementById("reviews");
const nameInput = document.getElementById("nameInput");
const reviewInput = document.getElementById("reviewInput");
const submitBtn = document.getElementById("submitReviewBtn");
const formMessage = document.getElementById("form-message");

// Sanitize HTML to prevent XSS
function sanitizeHTML(str) {
  return str.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}

// Load reviews
async function loadReviews() {
  reviewsDiv.innerHTML = "<p>Loading reviews...</p>";
  try {
    const querySnapshot = await getDocs(collection(db, "reviews"));
    if (querySnapshot.empty) {
      reviewsDiv.innerHTML = "<p>No reviews yet. Be the first to leave one!</p>";
      return;
    }
    reviewsDiv.innerHTML = "";
    querySnapshot.forEach(doc => {
      const data = doc.data();
      reviewsDiv.innerHTML += `<p><strong>${sanitizeHTML(data.name)}:</strong> ${sanitizeHTML(data.review)}</p>`;
    });
  } catch(e) {
    reviewsDiv.innerHTML = "<p>Error loading reviews.</p>";
    console.error(e);
  }
}

// Submit new review
submitBtn.addEventListener("click", async () => {
  const name = nameInput.value.trim();
  const review = reviewInput.value.trim();
  if(!name || !review){
    formMessage.style.color="red";
    formMessage.textContent="Please enter both name and review.";
    return;
  }
  try {
    await addDoc(collection(db,"reviews"), { name, review });
    formMessage.style.color="green";
    formMessage.textContent="Thank you for your review!";
    nameInput.value=""; reviewInput.value="";
    loadReviews();
  } catch(e){
    formMessage.style.color="red";
    formMessage.textContent="Error submitting review.";
    console.error(e);
  }
});

loadReviews();
</script>

</body>
</html>
